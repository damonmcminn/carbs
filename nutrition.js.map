{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/js/index.js","nutrition.js","node_modules/browserify/node_modules/querystring-es3/decode.js","node_modules/browserify/node_modules/querystring-es3/encode.js","node_modules/browserify/node_modules/querystring-es3/index.js","src/js/carbController.js","src/js/carbFactory.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"CarbController","CarbFactory","angular","module","factory","controller","./carbController","./carbFactory",2,"hasOwnProperty","obj","prop","Object","prototype","qs","sep","eq","options","regexp","split","maxKeys","len","kstr","vstr","k","v","x","replace","idx","indexOf","substr","decodeURIComponent","isArray","push","Array","xs","toString",3,"map","res","stringifyPrimitive","isFinite","name","undefined","objectKeys","ks","encodeURIComponent","join","keys","key",4,"decode","parse","encode","stringify","./decode","./encode",5,"success","data","vm","food","concat","results","error","httpError","errorMessage","message","serverError","cf","this","search","prevSearch","words","weight","then","loadMore","getNext","next","clear",6,"calcMacro","macro","isPercentage","Math","round","Number","toFixed","processResults","mass","none","foods","more","links","unit","carbs","carbohydrate","$http","$location","findFood","url","get","OK","status","defaults","useXDomain","headers","common","isLocal","host","localhost","webhost","terms","filter","word","req","querystring"],"mappings":"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","file":"nutrition.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","var CarbController = require('./carbController');\nvar CarbFactory = require('./carbFactory');\n\nangular.module('nutrition', [])\n  .factory('CarbFactory', ['$http', '$location', CarbFactory])\n  .controller('CarbController', ['CarbFactory', CarbController])\n",null,"// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","module.exports = CarbController;\n\nfunction CarbController(CarbFactory) {\n  var cf = CarbFactory;\n  var vm = this;\n  var serverError = 'There was an error contacting the server.';\n\n  vm.httpError = false;\n  vm.food = [];\n\n  function success(data) {\n    vm.food = vm.food.concat(data.food);\n    vm.results = data.results;\n  }\n\n  function error(res) {\n    vm.httpError = true;\n    vm.errorMessage = res.data ? res.data.message : serverError;\n    vm.food = [];\n    vm.results = {};\n  }\n\n  vm.search = function() {\n    vm.httpError = false;\n    vm.prevSearch = vm.words;\n    // success callback concats\n    vm.food = [];\n    cf.search(vm.words, vm.weight)\n      .then(success, error);\n  };\n\n  vm.loadMore = function() {\n    vm.httpError = false;\n    cf.getNext(vm.results.next, vm.weight)\n      .then(success, error);\n  };\n\n  vm.clear = function(form) {\n    vm.httpError = false;\n    vm.food = [];\n    vm.results = {};\n  };\n}\n","var qs = require('querystring');\n\nmodule.exports = CarbFactory;\n\nfunction calcMacro(macro, weight, isPercentage) {\n  if (isPercentage) {\n    return Math.round(macro * weight * 100);\n  } else {\n    return Number(macro * weight).toFixed(2);\n  }\n}\n\nfunction processResults(data, mass, isPercentage) {\n  return {\n    results: {\n      none: (data.foods.length === 0),\n      more: (data.links.next !== undefined),\n      unit: isPercentage ? '%' : 'g',\n      next: data.links.next\n    },\n    food: data.foods.map(function(food) {\n      return {\n        name: food.name,\n        carbs: calcMacro(food.carbohydrate, mass, isPercentage)\n      }\n    })\n  }\n}\n\nfunction CarbFactory($http, $location) {\n\n  // CORS stuff\n  $http.defaults.useXDomain = true;\n  delete $http.defaults.headers.common['X-Requested-With'];\n\n  var isLocal = ($location.host() === 'localhost');\n  var localhost = 'http://api.dev/nutrition/food';\n  var webhost = 'https://api.damonmcminn.com/nutrition/food';\n  var host = (isLocal ? localhost : webhost);\n  \n\n  function findFood(url, weight) {\n    var isPercentage = (weight === undefined);\n    var mass = weight || 1;\n\n    return $http.get(url)\n      .then(function(res) {\n        var OK = (res.status === 200);\n        return OK ? processResults(res.data, mass, isPercentage) : {};\n      });\n  }\n\n  return {\n    search: function(search, weight) {\n      // 'polar bear' -> 'search=polar&search=bear'\n      // 'polar     bear' -> 'search=polar&search=bear'\n      var terms = search.split(' ')\n        .filter(function(word) {\n          return word.length > 0;\n        });\n      var req = host + '?' + qs.stringify({search: terms});\n      return findFood(req, weight);\n    },\n    getNext: findFood,\n  }\n}\n"],"sourceRoot":"/source/"}